{% extends 'base.html.twig' %} 

{% block title %} {% if title is defined %} {{ title }} {% endif %}{% endblock %} 
{% block content %} {% if is_granted('ROLE_ADMIN') %}
<div id="page-inner">
  <div class="row">
    <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading">
          <div class="row">
            <div class="col-md-4">FIL(S) ou FILLE(S) DE :</div>
          </div>
        </div>
        <div class="panel-body">
          <div class="table-responsive">
            <table
              class="table table-striped table-bordered table-hover"
              id="dataTables-example"
            >
              <thead>
                <tr>
                  <th>Id</th>
                  <th>Parents</th>
                  <th>Enfant</th>
                  <th>ACTION</th>
                </tr>
              </thead>
              <tbody>
                {% for enfant in enfants %}
                <tr>
                  <td>{{ enfant.id }}</td>
                  <td>{{ enfant.parent.coinjoint.nom }} | {{ enfant.parent.coinjointe.nom }}</td>
                  <td>{{ enfant.enfant.nom }} {{ enfant.enfant.prenom }}</td>
                  
                  {% if is_granted('ROLE_ADMIN') %}
                  <th>
                    <a href="{{ path('app_dashboard_enfant_delete', {'id': enfant.id}) }}" style="cursor:pointer"
                      onClick="return confirm('Voulez-vous supprimer vraiment cette ligne ??')"
                      ><i
                        class="fa fa-trash"
                        style="color: red; margin-right: 5px"
                        aria-hidden="true"
                      ></i
                    ></a>
                    <a href="{{ path('app_dashboard_enfant_edit', {'id': enfant.id}) }}" style="cursor:pointer"
                      ><i
                        class="fa fa-edit"
                        style="color: green"
                        aria-hidden="true"
                      ></i
                    ></a>
                    <a 
                      onClick="showEnfant('{{enfant.id}}', '{{ path('app_dashboard_enfant_id', {'id': enfant.id}) }}')" 
                      data-toggle="modal" data-target="#myModal" style="cursor:pointer;"><i class="fa fa-eye" style="color:sky;" 
                      aria-hidden="true"></i></a>
                  </th>
                  {% endif %}
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endif %} 

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" onClick="loadFonction()" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title" id="myModalLabel">Apropos d'enfant</h4>
      </div>
      <div class="modal-body" id="modal-body"></div>
  </div>
</div>
</div>
{% endblock %}

{% block javascripts %}
  <script>

      function showEnfant(id, pathRoute){
        $.ajax({
          type: "POST",
          url: pathRoute,
          data:{ id : id},
          async: true,
          success: function(response){
            console.log(response);
            var html = '';
            html += '<ul>';
            html += '<th><strong>ID</strong>: '+ response.id +'</th><br />';
            html += '<th><strong>NOM</strong>: '+ response.nom +'</th><br />';
            html += '<th><strong>PRENOM</strong>: '+ response.prenom +'</th><br />';
            html += '<th><strong>DATE DE NAISSANCE</strong>: '+ response.dateNaissance +'</th><br />';
            html += '<th><strong>LIEU DE NAISSANCE</strong>: '+ response.lieuNaissance + '</th><br />';
            html += '<th><strong>NATIONALITE</strong>:  '+ response.nationalite +' </th><br />';
            html += '<th><strong>SITUATION MARITAL</strong> : '+ response.situationMarital +'</th><br />';
            html += '<th><strong>GROUPE SANGUIN</strong> : '+ response.groupSangin +'</th><br />';
            html += '<th><strong>PAYS D\'ORIGINE</strong> : '+ response.paysOrigin +'</th>';
            $("#modal-body").html(html);
          }
        })
      }

  </script>
{% endblock %}
